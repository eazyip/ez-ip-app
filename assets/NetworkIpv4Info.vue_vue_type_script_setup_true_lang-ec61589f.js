var x=Object.defineProperty;var S=(t,e,s)=>e in t?x(t,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[e]=s;var r=(t,e,s)=>(S(t,typeof e!="symbol"?e+"":e,s),s);import{d as V,o as c,f,h as i,t as u,i as w,j as h,c as m,k}from"./index-80aa8f3b.js";class n{constructor(e){r(this,"value");r(this,"base10Value");if(!n.isValid(e))throw new g(e);this.value=e,this.base10Value=parseInt(this.value,2)}static isValid(e){return!!/^[01]{32}$/.test(e)}toDecimal(){return new o(this.octets.map(e=>parseInt(e,2).toString()).join("."))}isMask(){return this.isSequentialBits(this.value.indexOf("0"),this.value.lastIndexOf("1"))}isWildCardMask(){return this.isSequentialBits(this.value.indexOf("1"),this.value.lastIndexOf("0"))}isSequentialBits(e,s){return s===-1||e===-1||s+1===e}add(e){if(this.base10Value===4294967295)throw new Error(`The binary value ${this.value} cannot be incremented by ${e.toString(2)}`);return new n((this.base10Value+e).toString(2).padStart(32,"0"))}substract(e){if(this.base10Value-e<0)throw new Error(`The binary value ${this.value} cannot be decremented by ${e.toString(2)}`);return new n((this.base10Value-e).toString(2).padStart(32,"0"))}bitwiseAnd(e){return new n(Array.from(e.value,(s,a)=>parseInt(s)&parseInt(this.value[a])).join(""))}bitwiseOr(e){return new n(Array.from(e.value,(s,a)=>parseInt(s)|parseInt(this.value[a])).join(""))}invert(){return new n(this.value.split("").map(e=>parseInt(e)^1).join(""))}get octets(){return this.value.match(/.{1,8}/g)}get dotted(){return this.octets.join(".")}}class g extends Error{constructor(e){super(`Invalid binary IPv4 address ${e}`),this.name="InvalidBinaryFormatError"}}class o{constructor(e){r(this,"value");if(!o.isValid(e))throw new E(`Invalid decimal IPv4 address ${e}`);this.value=e}static isValid(e){const s=e.split(".");return s.length!==4?!1:s.every(a=>/^\d+$/.test(a)&&Number(a)>=0&&Number(a)<=255)}toBinary(){return new n(this.octets.map(e=>e.toString(2).padStart(8,"0")).join(""))}get octets(){return this.value.split(".").map(e=>parseInt(e,10))}}class E extends Error{constructor(e){super(`Invalid decimal IPv4 address ${e}`),this.name="InvalidDecimalIpError"}}class l{constructor(e){r(this,"label","");r(this,"decimalValue");r(this,"binaryValue");typeof e=="string"&&(e.length===32?e=new n(e):e=new o(e)),e instanceof o?(this.decimalValue=e,this.binaryValue=this.decimalValue.toBinary()):(this.binaryValue=e,this.decimalValue=this.binaryValue.toDecimal())}setLabel(e){return this.label=e,this}nextAddress(e=1){return new l(this.binaryValue.add(e))}previousAddress(){return new l(this.binaryValue.substract(1))}lesserThan(e){return this.binaryValue.base10Value<e.binaryValue.base10Value}lesserThanOrEqualTo(e){return this.binaryValue.base10Value<=e.binaryValue.base10Value}equalTo(e){return this.binaryValue.base10Value===e.binaryValue.base10Value}greaterThanOrEqualTo(e){return this.binaryValue.base10Value>=e.binaryValue.base10Value}greaterThan(e){return this.binaryValue.base10Value>e.binaryValue.base10Value}}class I extends l{constructor(e){super(e),this.label="Broadcast address"}makeLastHostAddress(){return this.previousAddress()}}class b{constructor(e){r(this,"value");r(this,"size");r(this,"minValue",0);r(this,"maxValue",32);if(e>this.maxValue||e<this.minValue)throw new Error(`Invalid prfix value ${e}`);this.value=e,this.size=Math.pow(2,this.maxValue-this.value)-2}makeMask(){return new p(new n("1".repeat(this.value).padEnd(this.maxValue,"0")))}makeWildcard(){return new v(new n("0".repeat(this.value).padEnd(this.maxValue,"1")))}}class v extends l{constructor(e){if(super(e),this.label="Wildcard mask",!this.binaryValue.isWildCardMask())throw new Error(`Invalid wildcard mask value ${this.binaryValue.value}`)}makeMask(){return new p(this.binaryValue.invert())}makeBroadcastAddress(e){return new I(this.binaryValue.bitwiseOr(e.binaryValue))}makePrefix(){return new b(this.binaryValue.value.split("").reduce((e,s)=>e+(s==="0"?1:0),0))}}class M extends l{constructor(e){super(e),this.label="Network address"}makeFirstHostAddress(){return this.nextAddress()}}class p extends l{constructor(e){if(super(e),this.label="Mask",!this.binaryValue.isMask())throw new Error(`Invalid mask value ${this.binaryValue.value}`)}makeWildcard(){return new v(this.binaryValue.invert())}makeNetworkAddress(e){return new M(this.binaryValue.bitwiseAnd(e.binaryValue))}makePrefix(){return new b(this.binaryValue.value.split("").reduce((e,s)=>e+(s==="1"?1:0),0))}}class A{constructor(e,s){r(this,"label","");r(this,"mask");r(this,"prefix");r(this,"size");r(this,"wildcardMask");r(this,"networkAddress");r(this,"firstHostAddress",null);r(this,"lastHostAddress",null);r(this,"broadcastAddress");r(this,"subnets",new Map);this.mask=s,this.prefix=this.mask.makePrefix(),this.size=this.prefix.size,this.wildcardMask=this.mask.makeWildcard(),this.networkAddress=this.mask.makeNetworkAddress(e),this.broadcastAddress=this.wildcardMask.makeBroadcastAddress(e),this.prefix.value<31&&this.prefix.value>0&&(this.firstHostAddress=this.networkAddress.makeFirstHostAddress().setLabel("First host address"),this.lastHostAddress=this.broadcastAddress.makeLastHostAddress().setLabel("Last host address"))}setLabel(e){return this.label=e,this}containsSubnet(e){return this.networkAddress.lesserThanOrEqualTo(e.networkAddress)&&this.broadcastAddress.greaterThanOrEqualTo(e.broadcastAddress)}containsAddress(e){return this.networkAddress.lesserThanOrEqualTo(e)&&this.broadcastAddress.greaterThanOrEqualTo(e)}addSubnetBySize(e,s){if(this.subnets.has(e))throw new Error("Subnet name already in use");const a=new b(Math.floor(32-Math.log2(s+2))),y=a.makeMask();this.addSubnet(e,new A(this.resolveNewSubnetAddress(a.size),y))}addSubnet(e,s){this.subnets.set(e,{subnet:s,inRange:this.containsSubnet(s)})}resolveNewSubnetAddress(e){return this.subnets.size===0?this.networkAddress:this.lastSubnet().broadcastAddress.nextAddress(e+2)}lastSubnet(){return this.subnets.size===0?null:Array.from(this.subnets.values()).pop().subnet}sortSubnets(){const e=[...this.subnets.entries()].sort((s,a)=>a[1].subnet.size-s[1].subnet.size);this.subnets=new Map,e.forEach(s=>{this.addSubnetBySize(s[0],s[1].subnet.size)})}getSubnet(e){return this.subnets.get(e)}removeSubnet(e){this.subnets.delete(e)}getSubnets(){return this.subnets}getSubnetsCount(){return this.subnets.size}}const T={class:"flex flex-wrap gap-1 items-center"},z={class:"w-36"},$={class:"p-1 bg-slate-300 rounded-sm text-sm font-mono"},q={class:"p-1 bg-slate-300 rounded-sm text-sm font-mono"},d=V({__name:"AddressIpv4Info",props:{address:{type:Object,required:!0},label:{type:String,required:!1}},setup(t){return(e,s)=>(c(),f("div",T,[i("p",z,u(t.label??t.address.label),1),i("p",$,u(t.address.decimalValue.value||""),1),i("p",q,u(t.address.binaryValue.dotted||""),1)]))}}),O={class:"flex flex-col gap-1 p-1"},B={class:"p-1 rounded-sm bg-slate-300 text-sm font-mono"},N={class:"p-1 rounded-sm bg-slate-300 text-sm font-mono"},P=V({__name:"NetworkIpv4Info",props:{network:{type:Object,required:!0},label:{type:String,required:!1}},setup(t){return(e,s)=>(c(),f("div",O,[i("div",null,[w(" prefix: "),i("span",B,u(t.network.prefix.value),1)]),i("div",null,[w(" size: "),i("span",N,u(t.network.prefix.size),1)]),h(d,{address:t.network.networkAddress},null,8,["address"]),t.network.firstHostAddress?(c(),m(d,{key:0,address:t.network.firstHostAddress},null,8,["address"])):k("",!0),t.network.lastHostAddress?(c(),m(d,{key:1,address:t.network.lastHostAddress},null,8,["address"])):k("",!0),h(d,{address:t.network.broadcastAddress},null,8,["address"]),h(d,{address:t.network.mask},null,8,["address"]),h(d,{address:t.network.wildcardMask},null,8,["address"])]))}});export{l as A,n as B,o as D,p as M,A as N,P as _};
